S'\n        data {\n            int<lower=1> n_observations;\n            int<lower=1> n_groups;\n\n            int<lower=0> groups[n_observations];\n            vector[n_observations] observations;\n\n            real<lower=0, upper=1> beta;\n            real<lower=0, upper=1> temperature;\n            real<lower=0, upper=1> relax;\n        }\n\n        parameters {\n            real alpha;\n            vector[n_groups] random_effects;\n\n            real<lower=0> tau2;\n            real<lower=0> sigma2;\n        }\n\n        transformed parameters {\n            vector[n_observations] mu;\n\n            real<lower=0> tau;\n            real<lower=0> sigma;\n\n            mu = alpha + random_effects[groups];\n            tau = sqrt(tau2);\n            sigma = sqrt(sigma2);\n        }\n\n        model {\n            // mean priors\n            target += normal_lpdf(random_effects | 0.0, tau)*relax;\n\n            // scale priors\n            target += inv_gamma_lpdf(tau2 | 2, 2);\n\n            // likelihood\n            target += temperature*beta*normal_lpdf(observations | mu, sigma);\n            target += temperature*(1-beta)*normal_lpdf(observations | alpha, sigma);\n        }\n        '
p1
.